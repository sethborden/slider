function toggleSlideShow(){ss.slideShowActive?endSlideShow():startSlideShow()}function startSlideShow(){ss.slideShowActive=!0,$("#slideshow-state").children().first().toggleClass("glyphicon-play"),$("#slideshow-state").children().first().toggleClass("glyphicon-pause"),$(document).trigger("imageLoaded")}function scaleImage(e,t,i,n){i.width/i.height;return i.height<t&&i.width<e?scales=n?i.height>=i.width?{w:t*i.width/i.height,h:t,scaled:!0}:{w:e,h:e*i.height/i.width,scaled:!0}:{w:i.width,h:i.height,scaled:!1}:(i.height>=t||i.width>=e)&&(scales=i.height>=i.width?{w:t*i.width/i.height,h:t,scaled:!0}:{w:e,h:e*i.height/i.width,scaled:!0}),(scales.w>=e||scales.h>=t)&&(scales=scales.h>=t?{w:t*scales.w/scales.h,h:t,scaled:!0}:{w:e,h:e*scales.h/scales.w,scaled:!0}),scales}function endSlideShow(){ss.slideShowActive=!1,$("#slideshow-state").children().first().toggleClass("glyphicon-play"),$("#slideshow-state").children().first().toggleClass("glyphicon-pause"),$("#timer-bar").stop(!0,!0),$("#timer-bar").width(0)}function enterAlbumMode(){var e=ss.images[ss.activeImage].data;e.hasOwnProperty("album")&&(ss.albumMode=!0,e.j="undefined"==typeof e.j?0:e.j,e.url=e.album.images[e.j].links.original,e.title=e.album.images[e.j].image.caption?e.album.images[e.j].image.caption+" ("+(e.j+1)+"/"+e.album.images.length+")":e.album.title+" ("+(e.j+1)+"/"+e.album.images.length+")",setupModal(!0))}function exitAlbumMode(){var e=ss.images[ss.activeImage].data;e.hasOwnProperty("album")&&ss.albumMode&&(ss.albumMode=!1,e.j=0,e.url=e.album.images[0].links.original,e.title=e.album.title,setupModal(!0))}function nextModalImage(){$("#imgur-link").hide(),ss.slideShowActive&&$("#timer-bar").width("0");var e=ss.images[ss.activeImage].data;(ss.unrollAlbums||ss.albumMode)&&e.hasOwnProperty("album")?(e.j="undefined"==typeof e.j?0:e.j,e.j+1===e.album.images.length?(ss.albumMode&&(ss.albumMode=!1),incrementModalImage()):e.j=e.j+1,e.url=e.album.images[e.j].links.original,e.title=e.album.images[e.j].image.caption?e.album.images[e.j].image.caption+" ("+(e.j+1)+"/"+e.album.images.length+")":e.album.title+" ("+(e.j+1)+"/"+e.album.images.length+")"):incrementModalImage(),setupModal(!0)}function incrementModalImage(){ss.activeImage=Number(ss.activeImage)<ss.images.length-1?Number(ss.activeImage)+1:0}function prevModalImage(){$("#imgur-link").hide();var e=ss.images[ss.activeImage].data;ss.unrollAlbums&&e.hasOwnProperty("album")?(e.j="undefined"==typeof e.j?0:e.j,0===e.j?decrementModalImage():e.j=e.j-1,e.url=e.album.images[e.j].links.original,e.title=e.album.images[e.j].image.caption?e.album.images[e.j].image.caption+" ("+(e.j+1)+"/"+e.album.images.length+")":e.album.title+" ("+(e.j+1)+"/"+e.album.images.length+")"):decrementModalImage(),setupModal(!0)}function decrementModalImage(){ss.activeImage=Number(ss.activeImage)>0?Number(ss.activeImage)-1:ss.images.length-1}function setupModal(e){if($("body").css("overflow","hidden"),e){var t=ss.activeImgEl;ss.activeImgEl=ss.nextImgEl,ss.nextImgEl=t}var i=ss.images[ss.activeImage].data,n=ss.activeImgEl;showLoader(ss.activeImgEl),showLoader(ss.nextImgEl);var a=new Image;$(a).load(function(){ss.imageState="loaded",setupImage(n,a,i),e&&($(ss.activeImgEl).fadeToggle("slow"),$(ss.nextImgEl).fadeToggle({duration:"slow",complete:function(){$(document).trigger("imageLoaded")}}))}),ss.imageState="loading",a.src=i.url,"imgur album"===i.source_type}function setupImage(e,t,i){var n=.9,a=$(window),s=ss.scaleUp,r=a.height()*n,o=a.width()*n,l=scaleImage(o,r,t,s);e.height(l.h),e.width(l.w),e.css("background-image",'url("'+i.url+'")'),e.css("background-size","cover"),e.css("background-repeat","none"),e.css("top",(a.height()-e.height())/2+"px"),e.css("left",(a.width()-e.width())/2+"px"),$("#title").html(setupImageTitle(i)),$("#modal-sub").text(i.subreddit),$("#reddit-link").attr("href","http://www.reddit.com"+i.permalink),$("#reddit-link").attr("target","_blank");var u=$("#modal-title").detach();e.append(u),$("#modal-window").show(),hideLoaders()}function setupImageTitle(e){return e.hasOwnProperty("album")?ss.albumMode?e.title:e.title+" (Album - "+e.album.images.length+" images)":e.title}function imageBoxFactory(e,t){var i=e.data;console.log(i.thumbnail);var n=65,a=i.subreddit.length>10?i.subreddit.substr(0,10)+"...":i.subreddit,s=(i.url,"default"===i.thumbnail?"images/default.png":"nsfw"===i.thumbnail?"images/nsfw.png":i.thumbnail),r="http://www.reddit.com"+i.permalink,o=i.title.replace(/"/g,"'").length>n?i.title.substr(0,n)+"...":i.title.replace(/"/g,"'"),l=$("<div>",{"class":"image"}),u=$("<div>",{"class":"overlay",i:t}),c=$("<div>",{"class":"image-description"}),d=$("<div>",{"class":"image-title"}),h=$("<a>",{href:r,target:"_blank",style:"target-new: tab; position: absolute; bottom: 5px;"}),m=$("<img>",{src:"images/reddit.png"});return l.css("background-image",'url("'+s+'")'),c.html(o),d.html("r/"+a),h.append(m),u.append(d),u.append(c),u.append(h),u.click(clickOverlay),l.append(u),l}function clickOverlay(){ss.activeImage=$(this).attr("i"),showLoader($(this)),setupModal()}function toggleMessage(e){var t=$("#messages");"none"===t.css("display")?(t.text(e),t.fadeIn()):t.fadeOut()}function hideLoaders(){$(".loading").remove()}function showLoader(e,t){var i=$("<img>",{"class":"loading",src:"loading.gif"});e.append(i),i.css("position","absolute"),"center"===t||void 0===t?(i.css("top",(e.height()-31)/2),i.css("left",(e.width()-31)/2)):(i.css("top",0),i.css("right",0))}function hideForm(){$("#images").empty(),ss.pinOptions||($(".reddit-form").slideUp("fast"),$(".header-info").text($("#subreddit").val()),$(".header").fadeIn())}!function(e){"use strict";function t(t,i){this.itemsArray=[],this.$element=e(t),this.$element.hide(),this.isSelect="SELECT"===t.tagName,this.multiple=this.isSelect&&t.hasAttribute("multiple"),this.objectItems=i&&i.itemValue,this.placeholderText=t.hasAttribute("placeholder")?this.$element.attr("placeholder"):"",this.inputSize=Math.max(1,this.placeholderText.length),this.$container=e('<div class="bootstrap-tagsinput col-sm-12"></div>'),this.$input=e('<input type="text" placeholder="'+this.placeholderText+'"/>').appendTo(this.$container),this.$element.after(this.$container);var n=(this.inputSize<3?3:this.inputSize)+"em";this.$input.get(0).style.cssText="width: "+n+" !important;",this.build(i)}function i(e,t){if("function"!=typeof e[t]){var i=e[t];e[t]=function(e){return e[i]}}}function n(e,t){if("function"!=typeof e[t]){var i=e[t];e[t]=function(){return i}}}function a(e){return e?l.text(e).html():""}function s(e){var t=0;if(document.selection){e.focus();var i=document.selection.createRange();i.moveStart("character",-e.value.length),t=i.text.length}else(e.selectionStart||"0"==e.selectionStart)&&(t=e.selectionStart);return t}function r(t,i){var n=!1;return e.each(i,function(e,i){if("number"==typeof i&&t.which===i)return n=!0,!1;if(t.which===i.which){var a=!i.hasOwnProperty("altKey")||t.altKey===i.altKey,s=!i.hasOwnProperty("shiftKey")||t.shiftKey===i.shiftKey,r=!i.hasOwnProperty("ctrlKey")||t.ctrlKey===i.ctrlKey;if(a&&s&&r)return n=!0,!1}}),n}var o={tagClass:function(){return"label label-info"},itemValue:function(e){return e?e.toString():e},itemText:function(e){return this.itemValue(e)},freeInput:!0,addOnBlur:!0,maxTags:void 0,maxChars:void 0,confirmKeys:[13,44],onTagExists:function(e,t){t.hide().fadeIn()},trimValue:!1,allowDuplicates:!1};t.prototype={constructor:t,add:function(t,i){var n=this;if(!(n.options.maxTags&&n.itemsArray.length>=n.options.maxTags||t!==!1&&!t)){if("string"==typeof t&&n.options.trimValue&&(t=e.trim(t)),"object"==typeof t&&!n.objectItems)throw"Can't add objects when itemValue option is not set";if(!t.toString().match(/^\s*$/)){if(n.isSelect&&!n.multiple&&n.itemsArray.length>0&&n.remove(n.itemsArray[0]),"string"==typeof t&&"INPUT"===this.$element[0].tagName){var s=t.split(",");if(s.length>1){for(var r=0;r<s.length;r++)this.add(s[r],!0);return void(i||n.pushVal())}}var o=n.options.itemValue(t),l=n.options.itemText(t),u=n.options.tagClass(t),c=e.grep(n.itemsArray,function(e){return n.options.itemValue(e)===o})[0];if(!c||n.options.allowDuplicates){if(!(n.items().toString().length+t.length+1>n.options.maxInputLength)){var d=e.Event("beforeItemAdd",{item:t,cancel:!1});if(n.$element.trigger(d),!d.cancel){n.itemsArray.push(t);var h=e('<span class="tag '+a(u)+'">'+a(l)+'<span data-role="remove"></span></span>');if(h.data("item",t),n.findInputWrapper().before(h),h.after(" "),n.isSelect&&!e('option[value="'+encodeURIComponent(o)+'"]',n.$element)[0]){var m=e("<option selected>"+a(l)+"</option>");m.data("item",t),m.attr("value",o),n.$element.append(m)}i||n.pushVal(),(n.options.maxTags===n.itemsArray.length||n.items().toString().length===n.options.maxInputLength)&&n.$container.addClass("bootstrap-tagsinput-max"),n.$element.trigger(e.Event("itemAdded",{item:t}))}}}else if(n.options.onTagExists){var p=e(".tag",n.$container).filter(function(){return e(this).data("item")===c});n.options.onTagExists(t,p)}}}},remove:function(t,i){var n=this;if(n.objectItems&&(t="object"==typeof t?e.grep(n.itemsArray,function(e){return n.options.itemValue(e)==n.options.itemValue(t)}):e.grep(n.itemsArray,function(e){return n.options.itemValue(e)==t}),t=t[t.length-1]),t){var a=e.Event("beforeItemRemove",{item:t,cancel:!1});if(n.$element.trigger(a),a.cancel)return;e(".tag",n.$container).filter(function(){return e(this).data("item")===t}).remove(),e("option",n.$element).filter(function(){return e(this).data("item")===t}).remove(),-1!==e.inArray(t,n.itemsArray)&&n.itemsArray.splice(e.inArray(t,n.itemsArray),1)}i||n.pushVal(),n.options.maxTags>n.itemsArray.length&&n.$container.removeClass("bootstrap-tagsinput-max"),n.$element.trigger(e.Event("itemRemoved",{item:t}))},removeAll:function(){var t=this;for(e(".tag",t.$container).remove(),e("option",t.$element).remove();t.itemsArray.length>0;)t.itemsArray.pop();t.pushVal()},refresh:function(){var t=this;e(".tag",t.$container).each(function(){var i=e(this),n=i.data("item"),s=t.options.itemValue(n),r=t.options.itemText(n),o=t.options.tagClass(n);if(i.attr("class",null),i.addClass("tag "+a(o)),i.contents().filter(function(){return 3==this.nodeType})[0].nodeValue=a(r),t.isSelect){var l=e("option",t.$element).filter(function(){return e(this).data("item")===n});l.attr("value",s)}})},items:function(){return this.itemsArray},pushVal:function(){var t=this,i=e.map(t.items(),function(e){return t.options.itemValue(e).toString()});t.$element.val(i,!0).trigger("change")},build:function(t){var a=this;if(a.options=e.extend({},o,t),a.objectItems&&(a.options.freeInput=!1),i(a.options,"itemValue"),i(a.options,"itemText"),n(a.options,"tagClass"),a.options.typeahead){var l=a.options.typeahead||{};n(l,"source"),a.$input.typeahead(e.extend({},l,{source:function(t,i){function n(e){for(var t=[],n=0;n<e.length;n++){var r=a.options.itemText(e[n]);s[r]=e[n],t.push(r)}i(t)}this.map={};var s=this.map,r=l.source(t);e.isFunction(r.success)?r.success(n):e.isFunction(r.then)?r.then(n):e.when(r).then(n)},updater:function(e){a.add(this.map[e])},matcher:function(e){return-1!==e.toLowerCase().indexOf(this.query.trim().toLowerCase())},sorter:function(e){return e.sort()},highlighter:function(e){var t=new RegExp("("+this.query+")","gi");return e.replace(t,"<strong>$1</strong>")}}))}if(a.options.typeaheadjs){var u=a.options.typeaheadjs||{};a.$input.typeahead(null,u).on("typeahead:selected",e.proxy(function(e,t){a.add(u.valueKey?t[u.valueKey]:t),a.$input.typeahead("val","")},a))}a.$container.on("click",e.proxy(function(){a.$element.attr("disabled")||a.$input.removeAttr("disabled"),a.$input.focus()},a)),a.options.addOnBlur&&a.options.freeInput&&a.$input.on("focusout",e.proxy(function(){0===e(".typeahead, .twitter-typeahead",a.$container).length&&(a.add(a.$input.val()),a.$input.val(""))},a)),a.$container.on("keydown","input",e.proxy(function(t){var i=e(t.target),n=a.findInputWrapper();if(a.$element.attr("disabled"))return void a.$input.attr("disabled","disabled");switch(t.which){case 8:if(0===s(i[0])){var r=n.prev();r&&a.remove(r.data("item"))}break;case 46:if(0===s(i[0])){var o=n.next();o&&a.remove(o.data("item"))}break;case 37:var l=n.prev();0===i.val().length&&l[0]&&(l.before(n),i.focus());break;case 39:var u=n.next();0===i.val().length&&u[0]&&(u.after(n),i.focus())}{var c=i.val().length;Math.ceil(c/5)}i.attr("size",Math.max(this.inputSize,i.val().length))},a)),a.$container.on("keypress","input",e.proxy(function(t){var i=e(t.target);if(a.$element.attr("disabled"))return void a.$input.attr("disabled","disabled");var n=i.val(),s=a.options.maxChars&&n.length>=a.options.maxChars;a.options.freeInput&&(r(t,a.options.confirmKeys)||s)&&(a.add(s?n.substr(0,a.options.maxChars):n),i.val(""),t.preventDefault());{var o=i.val().length;Math.ceil(o/5)}i.attr("size",Math.max(this.inputSize,i.val().length))},a)),a.$container.on("click","[data-role=remove]",e.proxy(function(t){a.$element.attr("disabled")||a.remove(e(t.target).closest(".tag").data("item"))},a)),a.options.itemValue===o.itemValue&&("INPUT"===a.$element[0].tagName?a.add(a.$element.val()):e("option",a.$element).each(function(){a.add(e(this).attr("value"),!0)}))},destroy:function(){var e=this;e.$container.off("keypress","input"),e.$container.off("click","[role=remove]"),e.$container.remove(),e.$element.removeData("tagsinput"),e.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){for(var t=this.$input[0],i=this.$container[0];t&&t.parentNode!==i;)t=t.parentNode;return e(t)}},e.fn.tagsinput=function(i,n){var a=[];return this.each(function(){var s=e(this).data("tagsinput");if(s)if(i||n){if(void 0!==s[i]){var r=s[i](n);void 0!==r&&a.push(r)}}else a.push(s);else s=new t(this,i),e(this).data("tagsinput",s),a.push(s),"SELECT"===this.tagName&&e("option",e(this)).attr("selected","selected"),e(this).val(e(this).val())}),"string"==typeof i?a.length>1?a:a[0]:a},e.fn.tagsinput.Constructor=t;var l=e("<div />");e(function(){e("input[data-role=tagsinput], select[multiple][data-role=tagsinput]").tagsinput()})}(window.jQuery),function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.Handlebars=e.Handlebars||t()}(this,function(){var e=function(){"use strict";function e(e){this.string=e}var t;return e.prototype.toString=function(){return""+this.string},t=e}(),t=function(e){"use strict";function t(e){return l[e]}function i(e){for(var t=1;t<arguments.length;t++)for(var i in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],i)&&(e[i]=arguments[t][i]);return e}function n(e){return e instanceof o?e.toString():null===e?"":e?(e=""+e,c.test(e)?e.replace(u,t):e):e+""}function a(e){return e||0===e?m(e)&&0===e.length?!0:!1:!0}function s(e,t){return(e?e+".":"")+t}var r={},o=e,l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},u=/[&<>"'`]/g,c=/[&<>"'`]/;r.extend=i;var d=Object.prototype.toString;r.toString=d;var h=function(e){return"function"==typeof e};h(/x/)&&(h=function(e){return"function"==typeof e&&"[object Function]"===d.call(e)});var h;r.isFunction=h;var m=Array.isArray||function(e){return e&&"object"==typeof e?"[object Array]"===d.call(e):!1};return r.isArray=m,r.escapeExpression=n,r.isEmpty=a,r.appendContextPath=s,r}(e),i=function(){"use strict";function e(e,t){var n;t&&t.firstLine&&(n=t.firstLine,e+=" - "+n+":"+t.firstColumn);for(var a=Error.prototype.constructor.call(this,e),s=0;s<i.length;s++)this[i[s]]=a[i[s]];n&&(this.lineNumber=n,this.column=t.firstColumn)}var t,i=["description","fileName","lineNumber","message","name","number","stack"];return e.prototype=new Error,t=e}(),n=function(e,t){"use strict";function i(e,t){this.helpers=e||{},this.partials=t||{},n(this)}function n(e){e.registerHelper("helperMissing",function(){if(1===arguments.length)return void 0;throw new r("Missing helper: '"+arguments[arguments.length-1].name+"'")}),e.registerHelper("blockHelperMissing",function(t,i){var n=i.inverse,a=i.fn;if(t===!0)return a(this);if(t===!1||null===t)return n(this);if(c(t))return t.length>0?(i.ids&&(i.ids=[i.name]),e.helpers.each(t,i)):n(this);if(i.data&&i.ids){var r=f(i.data);r.contextPath=s.appendContextPath(i.data.contextPath,i.name),i={data:r}}return a(t,i)}),e.registerHelper("each",function(e,t){if(!t)throw new r("Must pass iterator to #each");var i,n,a=t.fn,o=t.inverse,l=0,u="";if(t.data&&t.ids&&(n=s.appendContextPath(t.data.contextPath,t.ids[0])+"."),d(e)&&(e=e.call(this)),t.data&&(i=f(t.data)),e&&"object"==typeof e)if(c(e))for(var h=e.length;h>l;l++)i&&(i.index=l,i.first=0===l,i.last=l===e.length-1,n&&(i.contextPath=n+l)),u+=a(e[l],{data:i});else for(var m in e)e.hasOwnProperty(m)&&(i&&(i.key=m,i.index=l,i.first=0===l,n&&(i.contextPath=n+m)),u+=a(e[m],{data:i}),l++);return 0===l&&(u=o(this)),u}),e.registerHelper("if",function(e,t){return d(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||s.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper("unless",function(t,i){return e.helpers["if"].call(this,t,{fn:i.inverse,inverse:i.fn,hash:i.hash})}),e.registerHelper("with",function(e,t){d(e)&&(e=e.call(this));var i=t.fn;if(s.isEmpty(e))return t.inverse(this);if(t.data&&t.ids){var n=f(t.data);n.contextPath=s.appendContextPath(t.data.contextPath,t.ids[0]),t={data:n}}return i(e,t)}),e.registerHelper("log",function(t,i){var n=i.data&&null!==i.data.level?parseInt(i.data.level,10):1;e.log(n,t)}),e.registerHelper("lookup",function(e,t){return e&&e[t]})}var a={},s=e,r=t,o="2.0.0";a.VERSION=o;var l=6;a.COMPILER_REVISION=l;var u={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};a.REVISION_CHANGES=u;var c=s.isArray,d=s.isFunction,h=s.toString,m="[object Object]";a.HandlebarsEnvironment=i,i.prototype={constructor:i,logger:p,log:g,registerHelper:function(e,t){if(h.call(e)===m){if(t)throw new r("Arg not supported with multiple helpers");s.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){h.call(e)===m?s.extend(this.partials,e):this.partials[e]=t},unregisterPartial:function(e){delete this.partials[e]}};var p={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(e,t){if(p.level<=e){var i=p.methodMap[e];"undefined"!=typeof console&&console[i]&&console[i].call(console,t)}}};a.logger=p;var g=p.log;a.log=g;var f=function(e){var t=s.extend({},e);return t._parent=e,t};return a.createFrame=f,a}(t,i),a=function(e,t,i){"use strict";function n(e){var t=e&&e[0]||1,i=h;if(t!==i){if(i>t){var n=m[i],a=m[t];throw new d("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+a+").")}throw new d("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}}function a(e,t){if(!t)throw new d("No environment passed to template");if(!e||!e.main)throw new d("Unknown template object: "+typeof e);t.VM.checkRevision(e.compiler);var i=function(i,n,a,s,r,o,l,u,h){r&&(s=c.extend({},s,r));var m=t.VM.invokePartial.call(this,i,a,s,o,l,u,h);if(null===m&&t.compile){var p={helpers:o,partials:l,data:u,depths:h};l[a]=t.compile(i,{data:void 0!==u,compat:e.compat},t),m=l[a](s,p)}if(null!==m){if(n){for(var g=m.split("\n"),f=0,v=g.length;v>f&&(g[f]||f+1!==v);f++)g[f]=n+g[f];m=g.join("\n")}return m}throw new d("The partial "+a+" could not be compiled when running in runtime-only mode")},n={lookup:function(e,t){for(var i=e.length,n=0;i>n;n++)if(e[n]&&null!==e[n][t])return e[n][t]},lambda:function(e,t){return"function"==typeof e?e.call(t):e},escapeExpression:c.escapeExpression,invokePartial:i,fn:function(t){return e[t]},programs:[],program:function(e,t,i){var n=this.programs[e],a=this.fn(e);return t||i?n=s(this,e,a,t,i):n||(n=this.programs[e]=s(this,e,a)),n},data:function(e,t){for(;e&&t--;)e=e._parent;return e},merge:function(e,t){var i=e||t;return e&&t&&e!==t&&(i=c.extend({},t,e)),i},noop:t.VM.noop,compilerInfo:e.compiler},a=function(t,i){i=i||{};var s=i.data;a._setup(i),!i.partial&&e.useData&&(s=l(t,s));var r;return e.useDepths&&(r=i.depths?[t].concat(i.depths):[t]),e.main.call(n,t,n.helpers,n.partials,s,r)};return a.isTop=!0,a._setup=function(i){i.partial?(n.helpers=i.helpers,n.partials=i.partials):(n.helpers=n.merge(i.helpers,t.helpers),e.usePartial&&(n.partials=n.merge(i.partials,t.partials)))},a._child=function(t,i,a){if(e.useDepths&&!a)throw new d("must pass parent depths");return s(n,t,e[t],i,a)},a}function s(e,t,i,n,a){var s=function(t,s){return s=s||{},i.call(e,t,e.helpers,e.partials,s.data||n,a&&[t].concat(a))};return s.program=t,s.depth=a?a.length:0,s}function r(e,t,i,n,a,s,r){var o={partial:!0,helpers:n,partials:a,data:s,depths:r};if(void 0===e)throw new d("The partial "+t+" could not be found");return e instanceof Function?e(i,o):void 0}function o(){return""}function l(e,t){return t&&"root"in t||(t=t?p(t):{},t.root=e),t}var u={},c=e,d=t,h=i.COMPILER_REVISION,m=i.REVISION_CHANGES,p=i.createFrame;return u.checkRevision=n,u.template=a,u.program=s,u.invokePartial=r,u.noop=o,u}(t,i,n),s=function(e,t,i,n,a){"use strict";var s,r=e,o=t,l=i,u=n,c=a,d=function(){var e=new r.HandlebarsEnvironment;return u.extend(e,r),e.SafeString=o,e.Exception=l,e.Utils=u,e.escapeExpression=u.escapeExpression,e.VM=c,e.template=function(t){return c.template(t,e)},e},h=d();return h.create=d,h["default"]=h,s=h}(n,e,i,t,a);return s}),$(document).ready(function(){ss=new SliderShower,ss.init(),$("#fit-to-window").change(function(){ss.scaleUp=$(this).is(":checked")}),$("#unroll-albums").change(function(){ss.unrollAlbums=$(this).is(":checked")}),$("#time-frame").change(function(){ss.timeFrame=$(this).val(),ss.genBaseUrl()}),$("#history-depth").change(function(){ss.linksToGrab=$(this).val()}),$("#slide-duration").change(function(){ss.slideDuration=$(this).val()}),$("#user").change(function(){ss.user=$(this).val(),ss.genBaseUrl()}),$("#search-term").change(function(){ss.searchTerm=$(this).val(),ss.genBaseUrl()}),$("#subreddit-radio-button").click(function(){console.log("showing subreddit search"),$(".subreddit-search").show(),$(".user-search").hide()}),$("#user-radio-button").click(function(){console.log("showing user search"),$(".subreddit-search").hide(),$(".user-search").show()}),$(document).keydown(function(e){"none"!==$("#modal-window").css("display")?39===e.keyCode?(endSlideShow(),nextModalImage()):37===e.keyCode?(endSlideShow(),prevModalImage()):38!==e.keyCode||ss.albumMode?40===e.keyCode&&ss.albumMode?exitAlbumMode():27===e.keyCode?(endSlideShow(),$("body").css("overflow","auto"),$("#modal-window").hide()):83===e.keyCode?toggleSlideShow():32!==e.keyCode||$("input").is(":focus")||toggleSlideShow():enterAlbumMode():$("input").is(":focus")?console.log(e.keyCode):83===e.keyCode&&($(".overlay:first").trigger("click"),toggleSlideShow())}),$("#modal-overlay").click(function(){endSlideShow(),$("body").css("overflow","auto"),$("#modal-window").hide()}),$("#options-pin").tooltip().click(function(){$(this).toggleClass("glyphicon-pushpin"),$(this).toggleClass("glyphicon-record"),ss.pinOptions=!ss.pinOptions}),$(".modal-image").mouseenter(function(){$("#modal-title").show()}),$(".modal-image").mouseleave(function(){$("#modal-title").hide()}),$("#slide-show-button").click(function(e){e.preventDefault(),hideForm(),ss.reset()}),$("#fetchButton").click(function(e){e.preventDefault(),hideForm(),ss.reset(),$(".page-title").slideUp("fast"),toggleMessage("Loading images..."),window.setTimeout(function(){ss.getRedditInfo()},300)}),$(".reddit-form").mouseleave(function(){ss.pinOptions||ss.images.length>0&&($(".reddit-form").slideUp("fast"),$(".header").fadeIn())}),$("#slideshow-state").click(function(){toggleSlideShow()}),$(".header").click(function(){ss.headerTimeout=setTimeout(function(){$(".header").hide(),$(".reddit-form").slideDown("fast")},100)}),$("#title-toggle").click(function(){var e=$(this);$("#title").toggle(300,function(){e.text("-"===e.text()?"+":"-")})}),$("#subreddit").tagsinput({confirmKeys:[34,13,44],tagClass:"big"}),$("input").on("itemAdded",function(){ss.subreddits=$("#subreddit").val().split(",")}),$("input").on("itemRemoved",function(){ss.subreddits=$("#subreddit").val().split(",")})}),$(document).on("imageLoaded",function(){ss.slideShowActive&&$("#timer-bar").animate({width:"100%"},{duration:1e3*ss.slideDuration,easing:"linear"}).promise().done(function(){ss.slideShowActive&&nextModalImage()})}),$(document).on("foo",function(){toggleMessage()});var SliderShower=function(){this.images=[],this.activeImage=0,this.albumImage=0,this.slideShowActive=!1,this.nextPage="",this.subreddits=$("#subreddit").val().split(/\s/),this.searchTerm=$("#search-term").val(),this.timeFrame=$('#reddit-form select[name="time-frame"]').val(),this.linksToGrab=$("#history-depth").val(),this.scaleUp=$("#fit-to-window").is(":checked"),this.slideDuration=$("#slide-duration").val(),this.activeImgEl=$("#first-modal-image"),this.nextImgEl=$("#second-modal-image"),this.unrollAlbums=!1,this.albumMode=!1,this.pinOptions=!1};SliderShower.prototype.getSubreddits=function(){return this.subreddits.join("+")},SliderShower.prototype.genBaseUrl=function(e){var t,i="http://www.reddit.com/",n={},a="";i+=this.user?"user/"+this.user+"/submitted/.json":this.searchTerm?"r/"+this.getSubreddits()+"/search/.json":this.timeFrame?"r/"+this.getSubreddits()+"/top/.json":"r/"+this.getSubreddits()+".json",this.timeFrame&&(n.t=this.timeFrame,n.sort="top"),""!==this.searchTerm&&(n.restrict_sr="on",n.q=this.searchTerm.replace(" ","+"),n.sort=this.timeFrame&&"none"===this.timeFrame?"relevance":"top"),"undefined"!=typeof e&&(n.count=25,n.after=e);for(t in n)a+="&"+t+"="+n[t];return a=a.replace("&","?"),console.log(i+a),i+a},SliderShower.prototype.setNextPage=function(e){this.nextPage="undefined"==typeof e?this.genBaseUrl():this.genBaseUrl(e)},SliderShower.prototype.getRedditInfo=function(){var e=this,t=$.ajax({url:e.nextPage,async:!1});t.fail(function(){document.dispatchEvent(new Event("foo"))}),t.done(function(t){var i=e.filterImageLinks(t.data.children);i.forEach(function(t){e.images.length<e.linksToGrab&&(e.images.push(t),$("#images").append(imageBoxFactory(t,e.images.length-1)))})}).then(function(t){null!==t.data.after?(e.setNextPage(t.data.after),e.images.length<e.linksToGrab?e.getRedditInfo():document.dispatchEvent(new Event("foo"))):document.dispatchEvent(new Event("foo"))})},SliderShower.prototype.filterImageLinks=function(e){var t=[];return e.forEach(function(e){var i=e.data.url.match(/^https?:\/\/(?:i\.|m\.)?imgur\.com\/(?:a|gallery)\/([\w]+)(\..+)?(?:\/)?(?:#?\w*)?$/i);if(i){var n="http://api.imgur.com/2/album/"+encodeURIComponent(i[1])+".json";e.album_url=e.data.url,$.ajax({url:n,async:!1}).success(function(i){try{e.data.url=i.album.images[0].links.original,e.data.thumbnail=i.album.images[0].links.small_square,e.data.album=i.album,e.data.album.title=e.data.title,t.push(e)}catch(n){}}).fail(function(e){console.log(e)})}else e.data.url.match(/.*\.(?:png|jpg|jpeg|gif)/)&&t.push(e)}),t},SliderShower.prototype.loadError=function(){alert("Unable to load"+this.nextPage+" no such subreddit")},SliderShower.prototype.gatherAllImages=function(){this.getSinglePageFromReddit()},SliderShower.prototype.reset=function(){this.images=[],this.nextPage=this.genBaseUrl(),this.activeImage=0},SliderShower.prototype.init=function(){this.setNextPage()};