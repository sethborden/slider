function toggleSlideShow(){ss.slideShowActive?endSlideShow():startSlideShow()}function startSlideShow(){ss.slideShowActive=!0,$("#slideshow-state").children().first().toggleClass("glyphicon-play"),$("#slideshow-state").children().first().toggleClass("glyphicon-pause"),$(document).trigger("imageLoaded")}function scaleImage(e,t,i,s){i.width/i.height;return i.height<t&&i.width<e?scales=s?i.height>=i.width?{w:t*i.width/i.height,h:t,scaled:!0}:{w:e,h:e*i.height/i.width,scaled:!0}:{w:i.width,h:i.height,scaled:!1}:(i.height>=t||i.width>=e)&&(scales=i.height>=i.width?{w:t*i.width/i.height,h:t,scaled:!0}:{w:e,h:e*i.height/i.width,scaled:!0}),(scales.w>=e||scales.h>=t)&&(scales=scales.h>=t?{w:t*scales.w/scales.h,h:t,scaled:!0}:{w:e,h:e*scales.h/scales.w,scaled:!0}),scales}function endSlideShow(){ss.slideShowActive=!1,$("#slideshow-state").children().first().toggleClass("glyphicon-play"),$("#slideshow-state").children().first().toggleClass("glyphicon-pause"),$("#timer-bar").stop(!0,!0),$("#timer-bar").width(0)}function enterAlbumMode(){var e=ss.images[ss.activeImage].data;e.hasOwnProperty("album")&&(ss.albumMode=!0,e.j="undefined"==typeof e.j?0:e.j,e.url=e.album.images[e.j].links.original,e.title=e.album.images[e.j].image.caption?e.album.images[e.j].image.caption+" ("+(e.j+1)+"/"+e.album.images.length+")":e.album.title+" ("+(e.j+1)+"/"+e.album.images.length+")",setupModal(!0))}function exitAlbumMode(){var e=ss.images[ss.activeImage].data;e.hasOwnProperty("album")&&ss.albumMode&&(ss.albumMode=!1,e.j=0,e.url=e.album.images[0].links.original,e.title=e.album.title,setupModal(!0))}function nextModalImage(){$("#imgur-link").hide(),ss.slideShowActive&&$("#timer-bar").width("0");var e=ss.images[ss.activeImage].data;(ss.unrollAlbums||ss.albumMode)&&e.hasOwnProperty("album")?(e.j="undefined"==typeof e.j?0:e.j,e.j+1===e.album.images.length?(ss.albumMode&&(ss.albumMode=!1),incrementModalImage()):e.j=e.j+1,e.url=e.album.images[e.j].links.original,e.title=e.album.images[e.j].image.caption?e.album.images[e.j].image.caption+" ("+(e.j+1)+"/"+e.album.images.length+")":e.album.title+" ("+(e.j+1)+"/"+e.album.images.length+")"):incrementModalImage(),setupModal(!0)}function incrementModalImage(){ss.activeImage=Number(ss.activeImage)<ss.images.length-1?Number(ss.activeImage)+1:0}function prevModalImage(){$("#imgur-link").hide();var e=ss.images[ss.activeImage].data;ss.unrollAlbums&&e.hasOwnProperty("album")?(e.j="undefined"==typeof e.j?0:e.j,0===e.j?decrementModalImage():e.j=e.j-1,e.url=e.album.images[e.j].links.original,e.title=e.album.images[e.j].image.caption?e.album.images[e.j].image.caption+" ("+(e.j+1)+"/"+e.album.images.length+")":e.album.title+" ("+(e.j+1)+"/"+e.album.images.length+")"):decrementModalImage(),setupModal(!0)}function decrementModalImage(){ss.activeImage=Number(ss.activeImage)>0?Number(ss.activeImage)-1:ss.images.length-1}function setupModal(e){if($("body").css("overflow","hidden"),e){var t=ss.activeImgEl;ss.activeImgEl=ss.nextImgEl,ss.nextImgEl=t}var i=ss.images[ss.activeImage].data,s=ss.activeImgEl;showLoader(ss.activeImgEl,"top-right"),showLoader(ss.nextImgEl,"top-right");var a=new Image;$(a).load(function(){ss.imageState="loaded",setupImage(s,a,i),e&&($(ss.activeImgEl).fadeToggle("slow"),$(ss.nextImgEl).fadeToggle({duration:"slow",complete:function(){$(document).trigger("imageLoaded")}}))}),ss.imageState="loading",a.src=i.url,"imgur album"===i.source_type}function setupImage(e,t,i){var s=.9,a=$(window),n=ss.scaleUp,o=a.height()*s,r=a.width()*s,l=scaleImage(r,o,t,n);e.height(l.h),e.width(l.w),e.css("background-image",'url("'+i.url+'")'),e.css("background-size","cover"),e.css("background-repeat","none"),e.css("top",(a.height()-e.height())/2+"px"),e.css("left",(a.width()-e.width())/2+"px"),$("#title").html(setupImageTitle(i)),$("#modal-sub").text(i.subreddit),$("#reddit-link").attr("href","http://www.reddit.com"+i.permalink),$("#reddit-link").attr("target","_blank");var d=$("#modal-title").detach();e.append(d),$("#modal-window").show(),hideLoaders()}function setupImageTitle(e){return e.hasOwnProperty("album")?ss.albumMode?e.title:e.title+" (Album - "+e.album.images.length+" images)":e.title}function vcenter(e,t){var i,s,a,n,o;i=$(e).height(),t?(n=$(e).parent(),o=n.height(),a=n.css("top")+o/2-i/2):(s=$(window).height(),a=s/2-i/2),$(e).css("top",a)}function imageBoxFactory(e,t){var i=e.data,s=65,a=i.subreddit.length>10?i.subreddit.substr(0,10)+"...":i.subreddit,n=(i.url,"default"===i.thumbnail?"images/default.png":"nsfw"===i.thumbnail?"images/nsfw.png":i.thumbnail),o="http://www.reddit.com"+i.permalink,r=i.title.replace(/"/g,"'").length>s?i.title.substr(0,s)+"...":i.title.replace(/"/g,"'"),l=$("<div>",{"class":"image"}),d=$("<div>",{"class":"overlay",i:t}),u=$("<div>",{"class":"image-description"}),c=$("<div>",{"class":"image-title"}),h=$("<a>",{href:o,target:"_blank",style:"target-new: tab; position: absolute; bottom: 5px;"}),m=$("<img>",{src:"images/reddit.png"});return l.css("background-image",'url("'+n+'")'),u.html(r),c.html("r/"+a),h.append(m),d.append(c),d.append(u),d.append(h),d.click(clickOverlay),l.append(d),l}function clickOverlay(){ss.activeImage=$(this).attr("i"),showLoader($(this)),setupModal()}function toggleMessage(e){var t=$("#message-box"),i=$("#message-progress");"none"===t.css("display")?(i.text(e),t.fadeIn()):(t.fadeOut(),$("#progress-bar").attr("aria-valuenow",0).width(0),$("#message-progress").text(""))}function updateMessage(e){var t=$("#message-progress"),i=ss.images.length/ss.linksToGrab*100,s=$("#progress-bar");t.text(e),s.attr("aria-valuenow",i).width(i+"%")}function hideLoaders(){$(".csspinner").each(function(){$(this).toggleClass("csspinner"),$(this).toggleClass("ringed")})}function showLoader(e){e.toggleClass("csspinner"),e.toggleClass("ringed")}function hideForm(){$("#images").empty(),ss.pinOptions||($(".reddit-form").slideUp("fast"),createSubredditMenu(),$(".header").fadeIn())}function createSubredditMenu(){var e=ss.getSubreddits().split("+"),t=$(document.createDocumentFragment());$("#sub-list").empty(),e.forEach(function(e){t.append(genSubredditButton(e))}),$("#sub-list").append(t)}function genSubredditButton(e){var t=$("<span>",{"class":"sub-name",sub:e}).text(e);return t.click(function(){filterSubreddits(e,highlightOverlay)}),t}function filterSubreddits(e,t){var i=0;ss.images.forEach(function(s){s.data.subreddit.toLowerCase()===e&&t(i),i++})}function highlightOverlay(e){$(".overlay[i="+e+"]").parent().toggleClass("highlight-overlays")}!function(e){"use strict";function t(t,i){this.itemsArray=[],this.$element=e(t),this.$element.hide(),this.isSelect="SELECT"===t.tagName,this.multiple=this.isSelect&&t.hasAttribute("multiple"),this.objectItems=i&&i.itemValue,this.placeholderText=t.hasAttribute("placeholder")?this.$element.attr("placeholder"):"",this.inputSize=Math.max(1,this.placeholderText.length),this.$container=e('<div class="bootstrap-tagsinput col-sm-12"></div>'),this.$input=e('<input type="text" placeholder="'+this.placeholderText+'"/>').appendTo(this.$container),this.$element.after(this.$container);var s=(this.inputSize<3?3:this.inputSize)+"em";this.$input.get(0).style.cssText="width: "+s+" !important;",this.build(i)}function i(e,t){if("function"!=typeof e[t]){var i=e[t];e[t]=function(e){return e[i]}}}function s(e,t){if("function"!=typeof e[t]){var i=e[t];e[t]=function(){return i}}}function a(e){return e?l.text(e).html():""}function n(e){var t=0;if(document.selection){e.focus();var i=document.selection.createRange();i.moveStart("character",-e.value.length),t=i.text.length}else(e.selectionStart||"0"==e.selectionStart)&&(t=e.selectionStart);return t}function o(t,i){var s=!1;return e.each(i,function(e,i){if("number"==typeof i&&t.which===i)return s=!0,!1;if(t.which===i.which){var a=!i.hasOwnProperty("altKey")||t.altKey===i.altKey,n=!i.hasOwnProperty("shiftKey")||t.shiftKey===i.shiftKey,o=!i.hasOwnProperty("ctrlKey")||t.ctrlKey===i.ctrlKey;if(a&&n&&o)return s=!0,!1}}),s}var r={tagClass:function(){return"label label-info"},itemValue:function(e){return e?e.toString():e},itemText:function(e){return this.itemValue(e)},freeInput:!0,addOnBlur:!0,maxTags:void 0,maxChars:void 0,confirmKeys:[13,44],onTagExists:function(e,t){t.hide().fadeIn()},trimValue:!1,allowDuplicates:!1};t.prototype={constructor:t,add:function(t,i){var s=this;if(!(s.options.maxTags&&s.itemsArray.length>=s.options.maxTags||t!==!1&&!t)){if("string"==typeof t&&s.options.trimValue&&(t=e.trim(t)),"object"==typeof t&&!s.objectItems)throw"Can't add objects when itemValue option is not set";if(!t.toString().match(/^\s*$/)){if(s.isSelect&&!s.multiple&&s.itemsArray.length>0&&s.remove(s.itemsArray[0]),"string"==typeof t&&"INPUT"===this.$element[0].tagName){var n=t.split(",");if(n.length>1){for(var o=0;o<n.length;o++)this.add(n[o],!0);return void(i||s.pushVal())}}var r=s.options.itemValue(t),l=s.options.itemText(t),d=s.options.tagClass(t),u=e.grep(s.itemsArray,function(e){return s.options.itemValue(e)===r})[0];if(!u||s.options.allowDuplicates){if(!(s.items().toString().length+t.length+1>s.options.maxInputLength)){var c=e.Event("beforeItemAdd",{item:t,cancel:!1});if(s.$element.trigger(c),!c.cancel){s.itemsArray.push(t);var h=e('<span class="tag '+a(d)+'">'+a(l)+'<span data-role="remove"></span></span>');if(h.data("item",t),s.findInputWrapper().before(h),h.after(" "),s.isSelect&&!e('option[value="'+encodeURIComponent(r)+'"]',s.$element)[0]){var m=e("<option selected>"+a(l)+"</option>");m.data("item",t),m.attr("value",r),s.$element.append(m)}i||s.pushVal(),(s.options.maxTags===s.itemsArray.length||s.items().toString().length===s.options.maxInputLength)&&s.$container.addClass("bootstrap-tagsinput-max"),s.$element.trigger(e.Event("itemAdded",{item:t}))}}}else if(s.options.onTagExists){var g=e(".tag",s.$container).filter(function(){return e(this).data("item")===u});s.options.onTagExists(t,g)}}}},remove:function(t,i){var s=this;if(s.objectItems&&(t="object"==typeof t?e.grep(s.itemsArray,function(e){return s.options.itemValue(e)==s.options.itemValue(t)}):e.grep(s.itemsArray,function(e){return s.options.itemValue(e)==t}),t=t[t.length-1]),t){var a=e.Event("beforeItemRemove",{item:t,cancel:!1});if(s.$element.trigger(a),a.cancel)return;e(".tag",s.$container).filter(function(){return e(this).data("item")===t}).remove(),e("option",s.$element).filter(function(){return e(this).data("item")===t}).remove(),-1!==e.inArray(t,s.itemsArray)&&s.itemsArray.splice(e.inArray(t,s.itemsArray),1)}i||s.pushVal(),s.options.maxTags>s.itemsArray.length&&s.$container.removeClass("bootstrap-tagsinput-max"),s.$element.trigger(e.Event("itemRemoved",{item:t}))},removeAll:function(){var t=this;for(e(".tag",t.$container).remove(),e("option",t.$element).remove();t.itemsArray.length>0;)t.itemsArray.pop();t.pushVal()},refresh:function(){var t=this;e(".tag",t.$container).each(function(){var i=e(this),s=i.data("item"),n=t.options.itemValue(s),o=t.options.itemText(s),r=t.options.tagClass(s);if(i.attr("class",null),i.addClass("tag "+a(r)),i.contents().filter(function(){return 3==this.nodeType})[0].nodeValue=a(o),t.isSelect){var l=e("option",t.$element).filter(function(){return e(this).data("item")===s});l.attr("value",n)}})},items:function(){return this.itemsArray},pushVal:function(){var t=this,i=e.map(t.items(),function(e){return t.options.itemValue(e).toString()});t.$element.val(i,!0).trigger("change")},build:function(t){var a=this;if(a.options=e.extend({},r,t),a.objectItems&&(a.options.freeInput=!1),i(a.options,"itemValue"),i(a.options,"itemText"),s(a.options,"tagClass"),a.options.typeahead){var l=a.options.typeahead||{};s(l,"source"),a.$input.typeahead(e.extend({},l,{source:function(t,i){function s(e){for(var t=[],s=0;s<e.length;s++){var o=a.options.itemText(e[s]);n[o]=e[s],t.push(o)}i(t)}this.map={};var n=this.map,o=l.source(t);e.isFunction(o.success)?o.success(s):e.isFunction(o.then)?o.then(s):e.when(o).then(s)},updater:function(e){a.add(this.map[e])},matcher:function(e){return-1!==e.toLowerCase().indexOf(this.query.trim().toLowerCase())},sorter:function(e){return e.sort()},highlighter:function(e){var t=new RegExp("("+this.query+")","gi");return e.replace(t,"<strong>$1</strong>")}}))}if(a.options.typeaheadjs){var d=a.options.typeaheadjs||{};a.$input.typeahead(null,d).on("typeahead:selected",e.proxy(function(e,t){a.add(d.valueKey?t[d.valueKey]:t),a.$input.typeahead("val","")},a))}a.$container.on("click",e.proxy(function(){a.$element.attr("disabled")||a.$input.removeAttr("disabled"),a.$input.focus()},a)),a.options.addOnBlur&&a.options.freeInput&&a.$input.on("focusout",e.proxy(function(){0===e(".typeahead, .twitter-typeahead",a.$container).length&&(a.add(a.$input.val()),a.$input.val(""))},a)),a.$container.on("keydown","input",e.proxy(function(t){var i=e(t.target),s=a.findInputWrapper();if(a.$element.attr("disabled"))return void a.$input.attr("disabled","disabled");switch(t.which){case 8:if(0===n(i[0])){var o=s.prev();o&&a.remove(o.data("item"))}break;case 46:if(0===n(i[0])){var r=s.next();r&&a.remove(r.data("item"))}break;case 37:var l=s.prev();0===i.val().length&&l[0]&&(l.before(s),i.focus());break;case 39:var d=s.next();0===i.val().length&&d[0]&&(d.after(s),i.focus())}{var u=i.val().length;Math.ceil(u/5)}i.attr("size",Math.max(this.inputSize,i.val().length))},a)),a.$container.on("keypress","input",e.proxy(function(t){var i=e(t.target);if(a.$element.attr("disabled"))return void a.$input.attr("disabled","disabled");var s=i.val(),n=a.options.maxChars&&s.length>=a.options.maxChars;a.options.freeInput&&(o(t,a.options.confirmKeys)||n)&&(a.add(n?s.substr(0,a.options.maxChars):s),i.val(""),t.preventDefault());{var r=i.val().length;Math.ceil(r/5)}i.attr("size",Math.max(this.inputSize,i.val().length))},a)),a.$container.on("click","[data-role=remove]",e.proxy(function(t){a.$element.attr("disabled")||a.remove(e(t.target).closest(".tag").data("item"))},a)),a.options.itemValue===r.itemValue&&("INPUT"===a.$element[0].tagName?a.add(a.$element.val()):e("option",a.$element).each(function(){a.add(e(this).attr("value"),!0)}))},destroy:function(){var e=this;e.$container.off("keypress","input"),e.$container.off("click","[role=remove]"),e.$container.remove(),e.$element.removeData("tagsinput"),e.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){for(var t=this.$input[0],i=this.$container[0];t&&t.parentNode!==i;)t=t.parentNode;return e(t)}},e.fn.tagsinput=function(i,s){var a=[];return this.each(function(){var n=e(this).data("tagsinput");if(n)if(i||s){if(void 0!==n[i]){var o=n[i](s);void 0!==o&&a.push(o)}}else a.push(n);else n=new t(this,i),e(this).data("tagsinput",n),a.push(n),"SELECT"===this.tagName&&e("option",e(this)).attr("selected","selected"),e(this).val(e(this).val())}),"string"==typeof i?a.length>1?a:a[0]:a},e.fn.tagsinput.Constructor=t;var l=e("<div />");e(function(){e("input[data-role=tagsinput], select[multiple][data-role=tagsinput]").tagsinput()})}(window.jQuery),$(document).ready(function(){ss=new SliderShower,ss.init(),$("#fit-to-window").change(function(){ss.scaleUp=$(this).is(":checked")}),$("#unroll-albums").change(function(){ss.unrollAlbums=$(this).is(":checked")}),$("#get-nsfw").change(function(){ss.getNsfw=$(this).is(":checked")}),$("#time-frame").change(function(){ss.timeFrame=$(this).val(),ss.genBaseUrl()}),$("#history-depth").change(function(){ss.linksToGrab=$(this).val()}),$("#slide-duration").change(function(){ss.slideDuration=$(this).val()}),$("#user").change(function(){ss.user=$(this).val(),ss.genBaseUrl()}),$("#search-term").change(function(){ss.searchTerm=$(this).val(),ss.genBaseUrl()}),$("#subreddit-radio-button").click(function(){$("#user").val(""),ss.user=void 0,$(".user-search").hide(),$(".subreddit-search").show(),ss.setCookie(),ss.genBaseUrl()}),$("#user-radio-button").click(function(){$("#subreddit").tagsinput("removeAll"),$("#search-term").val(""),$(".subreddit-search").hide(),$(".user-search").show(),ss.setCookie(),ss.genBaseUrl()}),$("#next, .go-next").click(function(){endSlideShow(),nextModalImage()}),$("#prev, .go-prev").click(function(){endSlideShow(),prevModalImage()}),$("#modal-window").mousemove(function(){clearTimeout(window.a),$(".decoration").fadeIn(),window.a=setTimeout(function(){$(".decoration").fadeOut()},2e3)});var e={minDist:100,maxTime:1e3};$("#modal-window").on("touchstart",function(t){e.xstart=t.originalEvent.touches[0].clientX,e.timestart=t.timeStamp}),$("#modal-window").on("touchmove",function(e){e.preventDefault()}),$("#modal-window").on("touchend",function(t){e.xend=t.originalEvent.changedTouches[0].clientX,e.timeend=t.timeStamp,deltaX=e.xend-e.xstart,deltaT=e.timeend-e.timestart,deltaX<-1*e.minDist&&deltaT<e.maxTime?(endSlideShow(),prevModalImage()):deltaX>e.minDist&&deltaT<e.maxTime&&(endSlideShow(),nextModalImage())}),$("#next, #prev").mouseenter(function(){clearTimeout(window.a),$(".decoration").fadeIn()}),$(document).keydown(function(e){"none"!==$("#modal-window").css("display")?39===e.keyCode||78===e.keyCode?(endSlideShow(),nextModalImage()):37===e.keyCode||80===e.keyCode?(endSlideShow(),prevModalImage()):38!==e.keyCode||ss.albumMode?40===e.keyCode&&ss.albumMode?exitAlbumMode():27===e.keyCode?(endSlideShow(),$("body").css("overflow","auto"),$("#modal-window").hide()):83===e.keyCode?toggleSlideShow():32!==e.keyCode||$("input").is(":focus")||toggleSlideShow():enterAlbumMode():$("input").is(":focus")||83===e.keyCode&&($(".overlay:first").trigger("click"),toggleSlideShow())}),$("#modal-overlay").click(function(){endSlideShow(),$("body").css("overflow","auto"),$("#modal-window").hide()}),$("#options-pin").tooltip().click(function(){$(this).toggleClass("glyphicon-pushpin"),$(this).toggleClass("glyphicon-record"),ss.pinOptions=!ss.pinOptions}),$("#help-clicker").click(function(){$(".help-window").modal("show")}),$(".modal-image").mouseenter(function(){$("#modal-title").show()}),$(".modal-image").mouseleave(function(){ss.pinImageTitles||$("#modal-title").hide()}),$("#slide-show-button").click(function(e){e.preventDefault(),hideForm(),ss.reset()}),$("#fetchButton").click(function(e){e.preventDefault(),$(".header-container").hide(),hideForm(),ss.setCookie(),ss.reset(),toggleMessage(),window.setTimeout(function(){ss.getRedditInfo()},300)}),$("#image-title-pin").click(function(){$(this).toggleClass("glyphicon-pushpin"),$(this).toggleClass("glyphicon-record"),ss.pinImageTitles=!ss.pinImageTitles}),$("#hide-clicker").click(function(){ss.images.length>0&&($(".reddit-form").slideUp("fast"),$(".header").fadeIn())}),$("#slideshow-state, .go-play").click(function(){toggleSlideShow()}),$("#show-options").click(function(){ss.headerTimeout=setTimeout(function(){$(".header").hide(),$(".reddit-form").slideDown("fast")},100)}),vcenter($("#message-box")),vcenter($("#prev")),vcenter($("#next")),vcenter($("#prev div"),!0),vcenter($("#next div"),!0),$(window).on("resize",function(){vcenter($("#message-box")),vcenter($("#prev")),vcenter($("#next")),vcenter($("#prev div"),!0),vcenter($("#next div"),!0)}),$("#subreddit").tagsinput({confirmKeys:[34,13,44],tagClass:"big"}),""===ss.getSubreddits()&&$("#search-term").prop("disabled",!0),$("input").on("itemAdded",function(){ss.subreddits=$("#subreddit").val().split(","),""!==ss.getSubreddits&&$("#search-term").prop("disabled",!1)}),$("input").on("itemRemoved",function(){ss.subreddits=$("#subreddit").val().split(","),""===ss.getSubreddits()&&$("#search-term").prop("disabled",!0)}),ss.getCookie(),ss.setOptions()}),$(document).on("imageLoaded",function(){ss.slideShowActive&&$("#timer-bar").animate({width:"100%"},{duration:1e3*ss.slideDuration,easing:"linear"}).promise().done(function(){ss.slideShowActive&&nextModalImage()})}),$(document).on("addedImages",function(){var e="("+ss.images.length+"/"+ss.linksToGrab+")";updateMessage(e)}),$(document).on("foo",function(){toggleMessage()});var SliderShower=function(){this.images=[],this.activeImage=0,this.albumImage=0,this.slideShowActive=!1,this.nextPage="",this.subreddits=$("#subreddit").val().split(/\s/),this.searchTerm=$("#search-term").val(),this.timeFrame=$('#reddit-form select[name="time-frame"]').val(),this.linksToGrab=$("#history-depth").val(),this.scaleUp=$("#fit-to-window").is(":checked"),this.getNsfw=$("#get-nsfw").is(":checked"),this.unrollAlbums=$("#unroll-albums").is(":checked"),this.slideDuration=$("#slide-duration").val(),this.activeImgEl=$("#first-modal-image"),this.nextImgEl=$("#second-modal-image"),this.albumMode=!1,this.pinOptions=!1,this.pinImageTitles=!1};SliderShower.prototype.setOptions=function(){$("#subreddit").tagsinput("removeAll"),this.subreddits.forEach(function(e){$("#subreddit").tagsinput("add",e.trim())}),$("#search-term").val(this.searchTerm),$("#time-frame").val(this.timeFrame),$("#history-depth").val(this.linksToGrab),$("#slide-duration").val(this.slideDuration),$("#fit-to-window").prop("checked",this.scaleUp),$("#get-nsfw").prop("checked",this.getNsfw),$("#unroll-albums").prop("checked",this.unrollAlbums),this.genBaseUrl()},SliderShower.prototype.getSubreddits=function(){return this.subreddits.join("+")},SliderShower.prototype.genBaseUrl=function(e){var t,i="http://www.reddit.com/",s={},a="";i+=this.user?"user/"+this.user+"/submitted/.json":this.searchTerm?"r/"+this.getSubreddits()+"/search/.json":this.timeFrame?"r/"+this.getSubreddits()+"/top/.json":"r/"+this.getSubreddits()+".json",this.timeFrame&&(s.t=this.timeFrame,s.sort="top"),""!==this.searchTerm&&(s.restrict_sr="on",s.q=this.searchTerm.replace(" ","+"),s.sort=this.timeFrame&&"none"===this.timeFrame?"relevance":"top"),"undefined"!=typeof e&&(s.count=25,s.after=e);for(t in s)a+="&"+t+"="+s[t];return a=a.replace("&","?"),i+a},SliderShower.prototype.setNextPage=function(e){this.nextPage="undefined"==typeof e?this.genBaseUrl():this.genBaseUrl(e)},SliderShower.prototype.setCookie=function(){var e=JSON.stringify({sr:this.subreddits.join(","),st:this.searchTerm,un:this.user,tf:this.timeFrame,lg:this.linksToGrab,sd:this.slideDuration,si:this.scaleUp,ua:this.unrollAlbums,gn:this.getNsfw}),t=new Date(Date.now()+2592e6).toGMTString();document.cookie="options="+e+";expires="+t},SliderShower.prototype.getCookie=function(){var e=this;document.cookie.split(";").forEach(function(t){return-1!==t.trim().indexOf("options")?(t=JSON.parse(t.split("=")[1]),e.subreddits=t.sr.split(","),e.searchTerm=t.st,e.user=t.un,e.timeFrame=t.tf,e.linksToGrab=t.lg,e.slideDuration=t.sd,e.scaleUp=t.si,e.unrollAlbums=t.ua,e.getNsfw=t.gn,!0):!1})},SliderShower.prototype.getRedditInfo=function(){var e=this;$.ajax({url:e.nextPage}).fail(function(){document.dispatchEvent(new Event("foo"))}).done(function(t){var i=e.filterImageLinks(t.data.children),s=new Event("addedImages");i.forEach(function(t){e.images.length<e.linksToGrab&&(e.images.push(t),$("#images").append(imageBoxFactory(t,e.images.length-1)))}),document.dispatchEvent(s)}).then(function(t){null!==t.data.after?(e.setNextPage(t.data.after),e.images.length<e.linksToGrab?e.getRedditInfo():document.dispatchEvent(new Event("foo"))):(console.log("No after...sorry!"),document.dispatchEvent(new Event("foo")))})},SliderShower.prototype.filterImageLinks=function(e){var t=[];return ss.getNsfw||(e=e.filter(function(e){return!e.data.over_18})),e.forEach(function(e){var i=e.data.url.match(/^https?:\/\/(?:i\.|m\.)?imgur\.com\/(?:a|gallery)\/([\w]+)(\..+)?(?:\/)?(?:#?\w*)?$/i);if(i){var s="http://api.imgur.com/2/album/"+encodeURIComponent(i[1])+".json";e.album_url=e.data.url,$.ajax({url:s,async:!1}).success(function(i){try{e.data.url=i.album.images[0].links.original,e.data.thumbnail=i.album.images[0].links.small_square,e.data.album=i.album,e.data.album.title=e.data.title,t.push(e)}catch(s){}}).fail(function(e){console.log(e)})}else e.data.url.match(/.*\.(?:png|jpg|jpeg|gif)/)&&t.push(e)}),t},SliderShower.prototype.loadError=function(){alert("Unable to load"+this.nextPage+" no such subreddit")},SliderShower.prototype.gatherAllImages=function(){this.getSinglePageFromReddit()},SliderShower.prototype.reset=function(){this.images=[],this.nextPage=this.genBaseUrl(),this.activeImage=0},SliderShower.prototype.init=function(){this.setNextPage()};